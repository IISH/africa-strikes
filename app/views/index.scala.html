@*
 * This template takes a single argument, a String containing a
 * message to display.
 *@

@(  message: String,
    strikeForm: Form[Strike],
    sectors: List[Sector],
    sources: List[String],
    hiscoOccupations: List[OccupationHisco],
    causeOfDisputes: List[CauseOfDispute],
    identityElements: List[IdentityElement],
    strikeDefinitions: List[StrikeDefinition],
    countries: List[String],
    labourRelations: List[String],
    months: List[String],
    numberOfParticipants: List[String],
    years: List[Integer],
    days: List[Integer]
)

@*
 * Call the `main` template with two arguments. The first
 * argument is a `String` with the title of the page, the second
 * argument is an `Html` object containing the body of the page.
 *@
@import helper._
@main("Africa Strikes") {

    @*
     * Get an `Html` object by calling the built-in Play welcome
     * template and passing a `String` message.
     *@

    <script src="@routes.Assets.versioned("javascripts/jquery-3.1.1.js")" type="text/javascript"></script>
    <script src="@routes.Assets.versioned("javascripts/bootstrap.js")" type="text/javascript"></script>
    <script src="@routes.Assets.versioned("javascripts/selectize.js")" type="text/javascript"></script>

    @form(action = routes.HomeController.addStrike(), 'enctype -> "multipart/form-data") {
        <div class="container">
            <h2>Fill in the description of the strike.</h2>
            @message
            @*Source*@
            <div class="form-group">
                <div class="form-inline">
                @select(strikeForm("source"), sources.map(s => s -> s), '_label -> "Source", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Country*@
            <div class="form-group">
                <div class="selectize-control form-inline">
                @select(strikeForm("country"), countries.map(s => s -> s), '_label -> "Country", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Geographical context*@
            <div class="form-group">
                <div class="form-group" title="Select one of the three available options. If the strike takes place in a city or town, select urban. In case the strike takes place in mines or field located in areas away from urban centres select rural. For the cases this information is not available, select unknown.">
                    @inputRadioGroup(strikeForm("geographicalContext"), options = options("Urban geographical context" -> "Urban geographical context", "Rural geographical context" -> "Rural geographical context", "Unknown geographical context" -> "Unknown geographical context"), '_label -> "Geographical context")
                </div>
            </div>
            @*Location*@
            <div class="form-group">
                <div class="form-inline input-full-width">
                    @inputText(strikeForm("location"), '_label -> "Location", 'class -> "input-full-width form-control", 'title -> "Write the exact location of the strike as listed in the source. It can be the name of city or town and/or of a factory. In case the source provides both (place and factory/mine, etc.), please insert both separate by (,).")
                </div>
            </div>
            @*Year Strike Started*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("yearStart"), options = years.map(s => s.toString() -> s.toString()), '_label -> "Year the strike started", 'class -> "form-control input-full-width", 'title -> "Select year from the list box according to the information provided by the source.")
                </div>
            </div>
            @*Month Strike Started*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("monthStart"), months.map(s => s -> s), '_label -> "Month the strike started", 'id -> "monthStartStrikeSelect", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select month from the list box according to the information provided by the source. In case this information is not provided leave the field blank.")
                </div>
            </div>
            @*Day Strike Started*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("dayStart"), options = days.map(s => s.toString() -> s.toString()), '_label -> "Day the strike started", 'class -> "form-control input-full-width", 'title -> "Select day from the list box according to the information provided by the source. In case this information is not provided leave the field blank.")
                </div>
            </div>
            @*Year Strike Ended*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("yearEnd"), options = years.map(s => s.toString() -> s.toString()), '_label -> "Year the strike ended", 'class -> "form-control input-full-width", 'title -> "Select year from the list box according to the information provided by the source.")
                </div>
            </div>
            @*Month Strike Ended*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("monthEnd"), months.map(s => s -> s), '_label -> "Month the strike ended", 'id -> "monthEndStrikeSelect", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select month from the list box according to the information provided by the source. In case this information is not provided leave the field blank.")
                </div>
            </div>
            @*Day Strike Ended*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("dayEnd"), options = days.map(s => s.toString() -> s.toString()), '_label -> "Day the strike ended", 'class -> "form-control input-full-width", 'title -> "Select day from the list box according to the information provided by the source. In case this information is not provided leave the field blank.")
                </div>
            </div>
            @*Duration of the Strike*@
            <div class="form-group">
                <div class="form-inline">
                    @inputText(strikeForm("duration"), 'type -> "number", '_label -> "Duration", 'class -> "input-full-width form-control", 'title -> "Write down the number of days of the strike. In case this information is not provided, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Sectors of the Strike*@
            <div class="form-group">
                <div class="selectize-control form-inline">
                    @select(strikeForm("sectors"), sectors.map(s => s.id.toString() -> s.sectorName), '_label -> "Sectors", 'multiple -> "multiple", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Occupation HISCO first level*@
            <div class="form-group">
                <div class="selectize-control form-inline">
                    @select(strikeForm("hiscoOccupations"), hiscoOccupations.map(s => s.id.toString() -> s.occupationHiscoText), '_label -> "Occupations HISCO first level", 'multiple -> "multiple", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Occupation Strike*@
            <div class="form-group">
                <div class="selectize-control form-inline multi">
                    @inputText(strikeForm("occupations"), '_label -> "Occupations", 'class -> "input-full-width form-control selectized", 'title -> "Open field. Insert the name of the main occupation(s) of the workers on strike as listed in the source. In case this information is not provided leave the field blank.")
                </div>
            </div>
            @*Labour Relations*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("labourRelation"), labourRelations.map(s => s -> s), '_label -> "Labour relations", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select from the list box.\n Below please find a short definition of the four categories included in the list: non-working, reciprocal labour, tributary labour and commodified labour.\n o\tNon-Working:\n o\tReciprocal Labour: “work done for other members of the same household or a group of households that form a community\n o\tTributary Labour: “work based on obligations vis-à-vis the Polity” or the state (as in the case of serfs, forced labourers, etc.)\n o\tCommodified Labour: situations “where the worker – or in the case of unfree labour and the owner of the worker – sells their means of production or the products of their work” to the market and/or non-market oriented institutions.")
                </div>
            </div>
            @*Work Situation*@
            <div class="form-group">
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    @inputRadioGroup(strikeForm("workersSituation"), options = options("Free" -> "Free", "Unfree" -> "Unfree", "Unknown" -> "Unknow"), '_label -> "Workers on strike are:")
                </div>
            </div>
            @*Company Names*@
            <div class="form-group">
                <div class="selectize-control form-inline multi">
                    @inputText(strikeForm("companyNames"), '_label -> "Company names", 'class -> "input-full-width form-control selectized", 'title -> "Open field. Insert the name of the company or companies as listed in the source. In case this information is not provided leave the field blank.")
                </div>
            </div>
            @*Company Ownership*@
            <div class="form-group">
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    @inputRadioGroup(strikeForm("companyOwnership"), options = options("Public" -> "Public", "Private" -> "Private", "Unknown" -> "Unknow"), '_label -> "Company ownership")
                </div>
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    @inputRadioGroup(strikeForm("companyOwnershipSituated"), options = options("Foreign, multinational" -> "Foreign, multinational", "Local, national" -> "Local, national", "Unknown" -> "Unknow"), '_label -> "")
                </div>
            </div>
            @*Companies Involved*@
            <div class="form-group">
                @*<label>Companies involved in strike</label>*@
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    @inputRadioGroup(strikeForm("companiesInvolved"), options = options("1-50 companies involved" -> "1-50 companies involved", "Half sector" -> "Half sector", "Entire sector" -> "Entire sector", "Unknown" -> "Unknow"), '_label -> "Companies involved in strike")
                </div>
            </div>
            @*Participants Involved*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("participantsInvolved"), numberOfParticipants.map(s => s -> s), '_label -> "Number of participants involved (approximately)", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provided leave the field blank.")
                </div>
            </div>
            @*Type of Action*@
            <div class="form-group">
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    @inputRadioGroup(strikeForm("typeOfAction"), options = options("Planned action" -> "Planned action", "Spontaneous action" -> "Spontaneous action", "Unknown" -> "Unknow"), '_label -> "Type of action")
                </div>
            </div>
            @*Type of Organization*@
            <div class="form-group">
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    @inputRadioGroup(strikeForm("typeOfOrganisation"), options = options("Trade union, association, brotherhood, etc." -> "Trade union, association, brotherhood, etc.", "Unorganised" -> "Unorganised", "Unknown" -> "Unknow"), '_label -> "Type of organisation")
                </div>
            </div>
            @*Dominant Gender*@
            <div class="form-group">
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    @inputRadioGroup(strikeForm("dominantGender"), options = options("Predominantly male" -> "Predominantly male", "Predominantly female" -> "Predominantly female", "Mixed" -> "Mixed" ,"Unknown" -> "Unknow"), '_label -> "Predominant gender")
                </div>
            </div>
            @*Cause of Dispute*@
            <div class="form-group">
                <div class="selectize-control form-inline">
                @select(strikeForm("causeOfDisputes"), causeOfDisputes.map(s => s.id.toString() -> s.causeOfDisputeText), '_label -> "Cause of disputes", 'multiple -> "multiple", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Identity Elements*@
            <div class="form-group">
                <div class="selectize-control form-inline">
                @select(strikeForm("identityElements"), identityElements.map(s => s.id.toString() -> s.identityElementText), '_label -> "Identity elements", 'multiple -> "multiple", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Identity Details*@
            <div class="form-group">
                <div class="selectize-control form-inline multi">
                    @inputText(strikeForm("identityDetails"), '_label -> "Identity details", 'class -> "input-full-width form-control selectized", 'title -> "Open field. Insert the information as listed in the source. For example if in the previous field you have selected ethnicity. In this field you can insert the name(s) of the ethnic groups involved in the strikes according to the information available in the sources. The same applied to other identity elements listed in the previous field.\nIn case this information is not provide leave the field blank.")
                </div>
            </div>
            @*Strike Definitions*@
            <div class="form-group">
                <div class="selectize-control form-inline">
                @select(strikeForm("strikeDefinitions"), strikeDefinitions.map(s => s.id.toString() -> s.strikeDefinitionText), '_label -> "Strike definitions", 'multiple -> "multiple", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Nature of the Strike*@
            <div class="form-group">
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    @inputRadioGroup(strikeForm("natureOfStrike"), options = options("Of violent nature" -> "Of violent nature", "Of non-violent nature" -> "Of non-violent nature", "Unknown nature of violence" -> "Unknown nature of violence"), '_label -> "Nature of the strike")
                </div>
            </div>
            @*Outcome of the Strike*@
            <div class="form-group">
                <div class="form-inline">
                    @inputText(strikeForm("outcomeOfStrike"), '_label -> "Outcome", 'class -> "input-full-width form-control", 'title -> "Open field. Insert the information as listed in the source. In case this information is not provided leave the field blank.")
                </div>
            </div>
            @*Description of the Strike*@
            <div class="form-group">
                <div class="form-inline">
                    @inputText(strikeForm("description"), '_label -> "Description", 'rows -> "5", 'class -> "input-full-width form-control", 'placeholder -> "Enter the description of the strike...", 'title -> "Open field. Here you can insert any information provided by the source that you consider relevant and is not registered in any of the fields included in the online form.")
                </div>
            </div>
            @*Arctile of the Strike*@
            <div class="form-group">
                <div class="form-inline input-full-width">
                    @inputFile(strikeForm("articleUpload"), '_label -> "Article upload", 'id -> "articleUploadButton", 'title -> "Upload a digital copy of the newspaper article from where you have extracted the information. Digital copies can be uploaded in PDF, JPEG or TIFF format.")
                </div>
            </div>
            @*Year of the Article*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("yearOfArticle"), options = years.map(s => s.toString() -> s.toString()), '_label -> "Year of uploaded article", 'class -> "form-control input-full-width", 'title -> "Select year from the list box according to the newspaper publication date. In case this information is not provided leave the field blank.")
                </div>
            </div>
            @*Month of the Article*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("monthOfArticle"), months.map(s => s -> s), '_label -> "Month of uploaded article", 'id -> "monthOfUploadedArticleSelect", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select month from the list box according to the information provided by the source. In case this information is not provided leave the field blank.")
                </div>
            </div>
            @*Day of the Article*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("dayOfArticle"), options = days.map(s => s.toString() -> s.toString()), '_label -> "Day of uploaded article", 'class -> "form-control input-full-width", 'title -> "Select day from the list box according to the newspaper publication date. In case this information is not provided leave the field blank.")
                </div>
            </div>
            @*Information of the Author*@
            <div class="form-group">
                <div class="form-inline">
                    @inputText(strikeForm("authorInformation"), '_label -> "Author information", 'class -> "input-full-width form-control", 'placeholder -> "Enter your own name...", 'title -> "Open field. Insert your name, so we can contact you later in case we have any questions concerning the information inserted in the form or the source you have used.")
                </div>
            </div>
            @*Submit button to save the specific strike*@
            <div class="form-group">
                <button name="addStrikeButton" id="addStrikeButton" onclick="isValid()">Add Strike</button>
            </div>
        </div>
    }


    <script type="text/javascript">

        $(document).ready(function(){

            $(function () {
                @*if(@message.compareTo(""))*@
                @*{*@
                    @*alert("Apparently message is not empty?");*@
                @*}*@
                @*else if(@message.compareTo("SourceStrike"))*@
                @*{*@
                    @*alert("The 'Source' was not filled out!");*@
                @*}*@
                @*else if(@message.compareTo("Country"))*@
                @*{*@
                    @*alert("The 'Country' was not selected!");*@
                @*}*@
                @*else if(@message.compareTo("YearStrikeStarted"))*@
                @*{*@
                    @*alert("The 'Year the strike started' was not selected!");*@
                @*}*@
                @*else if(@message.compareTo("Occupation"))*@
                @*{*@
                    @*alert("The 'Occupations' was not filled out!");*@
                @*}*@
                @*else if(@message.compareTo("WorkersSituation"))*@
                @*{*@
                    @*alert("The 'Workers on strike are:' was not selected!");*@
                @*}*@
                @*else if(@message.compareTo("DominantGender"))*@
                @*{*@
                    @*alert("The 'Predominant gender' was not selected!");*@
                @*}*@
                @*else if(@message.compareTo("Author"))*@
                @*{*@
                    @*alert("The 'Author' was not filled out!");*@
                @*}*@
            });

            function appendToSelect(inner, value, selector) {
                var el = document.createElement('option');
                el.innerHTML = inner;
                el.value = value;
                selector.appendChild(el);
            }

            $(function(){
                $('#sectors').selectize();
                $('#hiscoOccupations').selectize();
                $('#causeOfDisputes').selectize();
                $('#identityElements').selectize();
                $('#strikeDefinitions').selectize();
                $('#companyNames').selectize({
                    plugins: ['remove_button'],
                    create: function(input) {
                        return {
                            value: input,
                            text: input
                        }
                    }
                });
                $('#occupations').selectize({
                   plugins: ['remove_button'],
                    create:function(input){
                        return{
                            value: input,
                            text: input
                        }
                    }
                });
                $('#identityDetails').selectize({
                    plugins: ['remove_button'],
                    create:function(input){
                        return{
                            value: input,
                            text: input
                        }
                    }
                });
            });

            function updateArticleDayField() {
                var yearArticleElement = document.getElementById("yearOfUploadedArticleSelect");
                var monthArticleElement = document.getElementById("monthOfUploadedArticleSelect");
                var yearNum = yearArticleElement.options[yearArticleElement.selectedIndex].value;
                var monthNum = monthArticleElement.selectedIndex -1; // Due to the months containing a default value
                $('#dayOfUploadedArticleSelect').empty();
                for(var i = 0; i <= getNumberOfDays(yearNum, monthNum); i++) {
                    appendToSelect(i, i, document.getElementById("dayOfUploadedArticleSelect"));
                }
            }

            function updateStrikeDayField() {
                var yearStartElement = document.getElementById("yearStartStrikeSelect");
                var monthStartElement = document.getElementById("monthStartStrikeSelect");
                var yearNum = yearStartElement.options[yearStartElement.selectedIndex].value;
                var monthNum = monthStartElement.selectedIndex -1; // Due to the months containing a default value
                $('#dayStartStrikeSelect').empty();
                for(var i = 0; i <= getNumberOfDays(yearNum, monthNum); i++) {
                    appendToSelect(i, i, document.getElementById("dayStartStrikeSelect"));
                }
            }

            function updateStrikeDayEndField(){
                var yearEndElement = document.getElementById("yearEndStrikeSelect");
                var monthEndElement = document.getElementById("monthEndStrikeSelect");
                var yearNum = yearEndElement.options[yearEndElement.selectedIndex].value;
                var monthNum = monthEndElement.selectedIndex -1; // Due to the months containing a default value
                $('#dayEndStrikeSelect').empty();
                for(var i = 0; i <= getNumberOfDays(yearNum, monthNum); i++) {
                    appendToSelect(i, i, document.getElementById("dayEndStrikeSelect"));
                }
            }

            function getNumberOfDays(yearNumber, monthNumber) {
                var isLeap = ((yearNumber % 4) == 0 && ((yearNumber % 100) != 0 || (yearNumber % 400) == 0));
                return [31, (isLeap ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][monthNumber];
            }

            $("#yearOfUploadedArticleSelect").change(function () {
                updateArticleDayField();
            });

            $("#monthOfUploadedArticleSelect").change(function () {
                updateArticleDayField();
            });

            $("#yearStartStrikeSelect").change(function () {
                updateStrikeDayField();
            });

            $("#monthStartStrikeSelect").change(function () {
                updateStrikeDayField();
            });

            $('#yearEndStrikeSelect').change(function () {
               updateStrikeDayEndField();
            });

            $('#monthEndStrikeSelect').change(function () {
                updateStrikeDayEndField();
            })

            $("#articleUploadButton").change(function () {
                $("#uploadedArticleOutput").append(document.getElementById("articleUploadButton").value);
            });

        });
    </script>
}