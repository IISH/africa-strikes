@*
 * This template takes a single argument, a String containing a
 * message to display.
 *@

@(  message: String,
    strikeForm: Form[Strike],
    sectors: List[Sector],
    sources: List[String],
    hiscoOccupations: List[OccupationHisco],
    causeOfDisputes: List[CauseOfDispute],
    identityElements: List[IdentityElement],
    strikeDefinitions: List[StrikeDefinition],
    countries: List[String],
    labourRelations: List[String],
    months: List[String],
    numberOfParticipants: List[String]
)

@*
 * Call the `main` template with two arguments. The first
 * argument is a `String` with the title of the page, the second
 * argument is an `Html` object containing the body of the page.
 *@
@import helper._
@main("Africa Strikes") {

    @*
     * Get an `Html` object by calling the built-in Play welcome
     * template and passing a `String` message.
     *@

    <script src="@routes.Assets.versioned("javascripts/jquery-3.1.1.js")" type="text/javascript"></script>
    <script src="@routes.Assets.versioned("javascripts/bootstrap.js")" type="text/javascript"></script>
    <script src="@routes.Assets.versioned("javascripts/selectize.js")" type="text/javascript"></script>

    @form(action = routes.HomeController.addStrike(), 'enctype -> "multipart/form-data") {
        <div class="container">
            <h2>Fill in the description of the strike.</h2>
            @message
            @*Source*@
            <div class="form-group">
                <div class="form-inline">
                @select(strikeForm("source"), sources.map(s => s -> s), '_label -> "Source", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Country*@
            <div class="form-group">
                <div class="selectize-control form-inline">
                @select(strikeForm("country"), countries.map(s => s -> s), '_label -> "Country", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Geographical context*@
            <div class="form-group">
                <label>Geographical context</label>
                <div class="form-inline" title="Select one of the three available options. If the strike takes place in a city or town, select urban. In case the strike takes place in mines or field located in areas away from urban centres select rural. For the cases this information is not available, select unknown.">
                    <label class="radio-inline">
                        <input type="radio" name="geographicalContext" value="Urban geographical context">Urban geographical context
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="geographicalContext" value="Rural geographical context">Rural geographical context
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="geographicalContext" value="Unknown geographical context">Unknown geographical context
                    </label>
                </div>
            </div>
            @*Location*@
            <div class="form-group">
                <label>Location</label>
                <div class="form-inline input-full-width">
                    <input class="input-full-width form-control" type=text name="location" placeholder="Enter exact location..." title="Write the exact location of the strike as listed in the source. It can be the name of city or town and/or of a factory. In case the source provides both (place and factory/mine, etc.), please insert both separate by (,)."/>
                </div>
            </div>
            @*Year Strike Started*@
            <div class="form-group">
                <label>Year the strike started</label>
                <div class="form-inline">
                    <select class="form-control input-full-width" name="yearStart" id="yearStartStrikeSelect" title="Select year from the list box according to the information provided by the source."></select>
                </div>
            </div>
            @*Month Strike Started*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("monthStart"), months.map(s => s -> s), '_label -> "Month the strike started", 'id -> "monthStartStrikeSelect", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select month from the list box according to the information provided by the source. In case this information is not provide leave the field blank.")
                </div>
            </div>
            @*Day Strike Started*@
            <div class="form-group">
                <label>Day the strike started</label>
                <div class="form-inline">
                    <select class="form-control input-full-width" name="dayStart" id="dayStartStrikeSelect" title="Select day from the list box according to the information provided by the source. In case this information is not provide leave the field blank."></select>
                </div>
            </div>
            @*Year Strike Ended*@
            <div class="form-group">
                <label>Year the strike Ended</label>
                <div class="form-inline">
                    <select class="form-control input-full-width" name="yearEnd" id="yearEndStrikeSelect" title="Select year from the list box according to the information provided by the source.">
                    </select>
                </div>
            </div>
            @*Month Strike Ended*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("monthEnd"), months.map(s => s -> s), '_label -> "Month the strike ended", 'id -> "monthEndStrikeSelect", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select month from the list box according to the information provided by the source. In case this information is not provide leave the field blank.")
                </div>
            </div>
            @*Day Strike Ended*@
            <div class="form-group">
                <label>Day the strike ended</label>
                <div class="form-inline">
                    <select class="form-control input-full-width" name="dayEnd" id="dayEndStrikeSelect" title="Select day from the list box according to the information provided by the source. In case this information is not provide leave the field blank."></select>
                </div>
            </div>
            @*Duration of the Strike*@
            <div class="form-group">
                <label>Duration</label>
                <div class="form-inline">
                    <select class="form-control input-full-width" name="duration" id="durationOfStrikeSelect" title="Select number of days from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank."></select>
                </div>
            </div>
            @*Sectors of the Strike*@
            <div class="form-group">
                <div class="selectize-control form-inline">
                    @select(strikeForm("sectors.id"), sectors.map(s => s.getId().toString() -> s.sectorName), '_label -> "Sectors", 'multiple -> "multiple", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Occupation HISCO first level*@
            <div class="form-group">
                <div class="selectize-control form-inline">
                    @select(strikeForm("hiscoOccupations.id"), hiscoOccupations.map(s => s.id.toString() -> s.occupationHiscoText), '_label -> "Occupations HISCO first level", 'multiple -> "multiple", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Occupation Strike*@
            <div class="form-group">
                <label>Occupations</label>
                <div class="selectize-control form-inline multi">
                    <input class="input-full-width selectized" type=text name="occupations[]" id="occupations" placeholder="Enter occupations..." title="Open field. Insert the name of the main occupation(s) of the workers on strike as listed in the source. In case this information is not provide leave the field blank."/>
                </div>
            </div>
            @*Labour Relations*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("labourRelation"), labourRelations.map(s => s -> s), '_label -> "Labour relations", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select from the list box.\n Below please find a short definition of the four categories included in the list: non-working, reciprocal labour, tributary labour and commodified labour.\n o\tNon-Working:\n o\tReciprocal Labour: “work done for other members of the same household or a group of households that form a community\n o\tTributary Labour: “work based on obligations vis-à-vis the Polity” or the state (as in the case of serfs, forced labourers, etc.)\n o\tCommodified Labour: situations “where the worker – or in the case of unfree labour and the owner of the worker – sells their means of production or the products of their work” to the market and/or non-market oriented institutions.")
                </div>
            </div>
            @*Work Situation*@
            <div class="form-group">
                <label>Workers on strike are:</label>
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    <label class="radio-inline">
                        <input type="radio" name="workersSituation" id="workersSituation" value="Free">Free
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="workersSituation" id="workersSituation" value="Unfree">Unfree
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="workersSituation" id="workersSituation" value="Unknown">Unknown
                    </label>
                </div>
            </div>
            @*Company Names*@
            <div class="form-group">
                <label>Company names</label>
                <div class="selectize-control form-inline multi">
                    <input class="input-full-width selectized" type=text name="companyNames[]" id="companyNames" placeholder="Enter company names..." title="Open field. Insert the name of the company or companies as listed in the source. In case this information is not provide leave the field blank."/>
                </div>
            </div>
            @*Company Ownership*@
            <div class="form-group">
                <label>Company ownership</label>
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    <label class="radio-inline">
                        <input type="radio" name="companyOwnership" value="Public">Public
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="companyOwnership" value="Private">Private
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="companyOwnership" value="Unknown">Unknown
                    </label>
                </div>
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    <label class="radio-inline">
                        <input type="radio" name="companyOwnershipSituated" value="Foreign">Foreign, multinational
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="companyOwnershipSituated" value="Local">Local, national
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="companyOwnershipSituated" value="Unknown">Unknown
                    </label>
                </div>
            </div>
            @*Companies Involved*@
            <div class="form-group">
                <label>Companies involved in strike</label>
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    <label class="radio-inline">
                        <input type="radio" name="companiesInvolved" value="1-50 companies involved">1-50 companies involved
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="companiesInvolved" value="Entire sector">Entire sector
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="companiesInvolved" value="Unknown">Unknown
                    </label>
                </div>
            </div>
            @*Participants Involved*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("participantsInvolved"), numberOfParticipants.map(s => s -> s), '_label -> "Number of participants involved", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provided leave the field blank.")
                </div>
            </div>
            @*Type of Action*@
            <div class="form-group">
                <label>Type of action</label>
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    <label class="radio-inline">
                        <input type="radio" name="typeOfAction" value="planned">Planned action
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="typeOfAction" value="spontaneous">Spontaneous action
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="typeOfAction" value="Unknown">Unknown
                    </label>
                </div>
            </div>
            @*Type of Organization*@
            <div class="form-group">
                <label>Type of organisation</label>
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    <label class="radio-inline">
                        <input type="radio" name="typeOfOrganisation" value="organised">Trade union, association, brotherhood, etc.
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="typeOfOrganisation" value="unorganised">Unorganised
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="typeOfOrganisation" value="Unknown">Unknown
                    </label>
                </div>
            </div>
            @*Dominant Gender*@
            <div class="form-group">
                <label>Predominant gender</label>
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    <label class="radio-inline">
                        <input type="radio" name="dominantGender" id="dominantGender" value="male">Predominantly male
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="dominantGender" id="dominantGender" value="female">Predominantly female
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="dominantGender" id="dominantGender" value="mixed">Mixed
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="dominantGender" id="dominantGender" value="Unknown">Unknown
                    </label>
                </div>
            </div>
            @*Cause of Dispute*@
            <div class="form-group">
                <div class="selectize-control form-inline">
                @select(strikeForm("causeOfDisputes.id"), causeOfDisputes.map(s => s.id.toString() -> s.causeOfDisputeText), '_label -> "Cause of disputes", 'multiple -> "multiple", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Identity Elements*@
            <div class="form-group">
                <div class="selectize-control form-inline">
                @select(strikeForm("identityElements.id"), identityElements.map(s => s.id.toString() -> s.identityElementText), '_label -> "Identity elements", 'multiple -> "multiple", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Identity Details*@
            <div class="form-group">
                <label>Identity details</label>
                <div class="selectize-control form-inline multi">
                    <input class="input-full-width selectized" type=text name="identityDetails[]" id="identityDetails" placeholder="Enter identity details..." title="Open field. Insert the name of the company or companies as listed in the source. In case this information is not provide leave the field blank."/>
                </div>
            </div>
            @*Strike Definitions*@
            <div class="form-group">
                <div class="selectize-control form-inline">
                @select(strikeForm("strikeDefinitions.id"), strikeDefinitions.map(s => s.id.toString() -> s.strikeDefinitionText), '_label -> "Strike definitions", 'multiple -> "multiple", 'placeholder -> "Please choose...", 'title -> "Select from the list box. In case this information is not provide, or you are not sure which option to select leave the field blank.")
                </div>
            </div>
            @*Nature of the Strike*@
            <div class="form-group">
                <label>Nature of the strike</label>
                <div class="form-inline" title="Select one of the option available. In case this information is not provided select unknown.">
                    <label class="radio-inline">
                        <input type="radio" name="natureOfStrike" value="violent">Of violent nature
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="natureOfStrike" value="non-violent">Of non-violent nature
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="natureOfStrike" value="Unknown">Unknown nature of violence
                    </label>
                </div>
            </div>
            @*Outcome of the Strike*@
            <div class="form-group">
                <label>Outcome</label>
                <div class="form-inline">
                    <input class="input-full-width form-control" type=text name="outcomeOfStrike" placeholder="Enter the outcome of the strike..." title="Open field. Insert the information as listed in the source. In case this information is not provide leave the field blank."/>
                </div>
            </div>
            @*Description of the Strike*@
            <div class="form-group">
                <label>Description</label>
                <div class="form-inline">
                    <textarea class="input-full-width form-control" name="description" rows="5" placeholder="Enter the description of the strike..." title="Open field. Here you can insert any information provided by the source that you consider relevant and is not registered in any of the fields included in the online form."></textarea>
                </div>
            </div>
            @*Arctile of the Strike*@
            <div class="form-group">
                <label>Article upload</label>
                <div class="form-inline input-full-width">
                    <input type="file" name="articleUpload" id="articleUploadButton" title="Upload a digital copy of the newspaper article from where you have extracted the information. Digital copies can be uploaded in PDF, JPEG or TIFF format."/>
                </div>
            </div>
            @*Year of the Article*@
            <div class="form-group">
                <label>Year of uploaded article</label>
                <div class="form-inline">
                    <select class="form-control input-full-width" name="yearOfArticle" id="yearOfUploadedArticleSelect" title="Select year from the list box according to the newspaper publication date. In case this information is not provide leave the field blank."></select>
                </div>
            </div>
            @*Month of the Article*@
            <div class="form-group">
                <div class="form-inline">
                    @select(strikeForm("monthOfArticle"), months.map(s => s -> s), '_label -> "Month of uploaded article", 'id -> "monthOfUploadedArticleSelect", 'class -> "form-control input-full-width", 'placeholder -> "Please choose...", 'title -> "Select month from the list box according to the information provided by the source. In case this information is not provide leave the field blank.")
                </div>
            </div>
            @*Day of the Article*@
            <div class="form-group">
                <label>Day of uploaded article</label>
                <div class="form-inline">
                    <select class="form-control input-full-width" name="dayOfArticle" id="dayOfUploadedArticleSelect" title="Select day from the list box according to the newspaper publication date. In case this information is not provide leave the field blank."></select>
                </div>
            </div>
            @*Information of the Author*@
            <div class="form-group">
                <label>Author Information</label>
                <div class="form-inline">
                    <input class="input-full-width form-control" type=text name="authorInformation" id="authorInformation" placeholder="Enter your own name..." title="Open field. Insert your name, so we can contact you later in case we have any questions concerning the information inserted in the form or the source you have used."/>
                </div>
            </div>

            @*Submit button to save the specific strike*@
            <div class="form-group">
                <button name="addStrikeButton" id="addStrikeButton" onclick="isValid()">Add Strike</button>
            </div>
        </div>
    }


    <script type="text/javascript">

        $(document).ready(function(){

            $(function () {
                @*if(@message.compareTo(""))*@
                @*{*@
                    @*alert("Apparently message is not empty?");*@
                @*}*@
                @*else if(@message.compareTo("SourceStrike"))*@
                @*{*@
                    @*alert("The 'Source' was not filled out!");*@
                @*}*@
                @*else if(@message.compareTo("Country"))*@
                @*{*@
                    @*alert("The 'Country' was not selected!");*@
                @*}*@
                @*else if(@message.compareTo("YearStrikeStarted"))*@
                @*{*@
                    @*alert("The 'Year the strike started' was not selected!");*@
                @*}*@
                @*else if(@message.compareTo("Occupation"))*@
                @*{*@
                    @*alert("The 'Occupations' was not filled out!");*@
                @*}*@
                @*else if(@message.compareTo("WorkersSituation"))*@
                @*{*@
                    @*alert("The 'Workers on strike are:' was not selected!");*@
                @*}*@
                @*else if(@message.compareTo("DominantGender"))*@
                @*{*@
                    @*alert("The 'Predominant gender' was not selected!");*@
                @*}*@
                @*else if(@message.compareTo("Author"))*@
                @*{*@
                    @*alert("The 'Author' was not filled out!");*@
                @*}*@
            });

            function appendToSelect(inner, value, selector) {
                var el = document.createElement('option');
                el.innerHTML = inner;
                el.value = value;
                selector.appendChild(el);
            }

            $(function(){
                $('#sectors_id').selectize();
                $('#hiscoOccupations_id').selectize();
                $('#causeOfDisputes_id').selectize();
                $('#identityElements_id').selectize();
                $('#strikeDefinitions_id').selectize();
                $('#companyNames').selectize({
                    plugins: ['remove_button'],
                    create: function(input) {
                        return {
                            value: input,
                            text: input
                        }
                    }
                });
                $('#occupations').selectize({
                   plugins: ['remove_button'],
                    create:function(input){
                        return{
                            value: input,
                            text: input
                        }
                    }
                });
                $('#identityDetails').selectize({
                    plugins: ['remove_button'],
                    create:function(input){
                        return{
                            value: input,
                            text: input
                        }
                    }
                });
            });

            $(function () {
                for(var i = 0; i <= 31; i++) {
                    appendToSelect(i, i, document.getElementById("dayStartStrikeSelect"));
                    appendToSelect(i, i, document.getElementById("dayEndStrikeSelect"));
                    appendToSelect(i, i, document.getElementById("dayOfUploadedArticleSelect"))
                }
            });

            $(function () {
                for(var i = 1700; i <= 2000; i++) {
                    appendToSelect(i, i, document.getElementById("yearStartStrikeSelect"));
                    appendToSelect(i, i, document.getElementById("yearEndStrikeSelect"));
                    appendToSelect(i, i, document.getElementById("yearOfUploadedArticleSelect"));
                }
            });

            $(function () {
                for(var i = 0; i <= 365; i++) {
                    appendToSelect(i, i, document.getElementById("durationOfStrikeSelect"));
                }
            });

            function updateArticleDayField() {
                var yearArticleElement = document.getElementById("yearOfUploadedArticleSelect");
                var monthArticleElement = document.getElementById("monthOfUploadedArticleSelect");
                var yearNum = yearArticleElement.options[yearArticleElement.selectedIndex].value;
                var monthNum = monthArticleElement.selectedIndex -1; // Due to the months containing a default value
                $('#dayOfUploadedArticleSelect').empty();
                for(var i = 0; i <= getNumberOfDays(yearNum, monthNum); i++) {
                    appendToSelect(i, i, document.getElementById("dayOfUploadedArticleSelect"));
                }
            }

            function updateStrikeDayField() {
                var yearStartElement = document.getElementById("yearStartStrikeSelect");
                var monthStartElement = document.getElementById("monthStartStrikeSelect");
                var yearNum = yearStartElement.options[yearStartElement.selectedIndex].value;
                var monthNum = monthStartElement.selectedIndex -1; // Due to the months containing a default value
                $('#dayStartStrikeSelect').empty();
                for(var i = 0; i <= getNumberOfDays(yearNum, monthNum); i++) {
                    appendToSelect(i, i, document.getElementById("dayStartStrikeSelect"));
                }
            }

            function updateStrikeDayEndField(){
                var yearEndElement = document.getElementById("yearEndStrikeSelect");
                var monthEndElement = document.getElementById("monthEndStrikeSelect");
                var yearNum = yearEndElement.options[yearEndElement.selectedIndex].value;
                var monthNum = monthEndElement.selectedIndex -1; // Due to the months containing a default value
                $('#dayEndStrikeSelect').empty();
                for(var i = 0; i <= getNumberOfDays(yearNum, monthNum); i++) {
                    appendToSelect(i, i, document.getElementById("dayEndStrikeSelect"));
                }
            }

            function getNumberOfDays(yearNumber, monthNumber) {
                var isLeap = ((yearNumber % 4) == 0 && ((yearNumber % 100) != 0 || (yearNumber % 400) == 0));
                return [31, (isLeap ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][monthNumber];
            }

            $("#yearOfUploadedArticleSelect").change(function () {
                updateArticleDayField();
            });

            $("#monthOfUploadedArticleSelect").change(function () {
                updateArticleDayField();
            });

            $("#yearStartStrikeSelect").change(function () {
                updateStrikeDayField();
            });

            $("#monthStartStrikeSelect").change(function () {
                updateStrikeDayField();
            });

            $('#yearEndStrikeSelect').change(function () {
               updateStrikeDayEndField();
            });

            $('#monthEndStrikeSelect').change(function () {
                updateStrikeDayEndField();
            })

            $("#articleUploadButton").change(function () {
                $("#uploadedArticleOutput").append(document.getElementById("articleUploadButton").value);
            });

        });
    </script>
}